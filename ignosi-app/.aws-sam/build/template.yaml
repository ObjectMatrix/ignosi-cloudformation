AWSTemplateFormatVersion: '2010-09-09'
Transform: AWS::Serverless-2016-10-31
Description: 'ignosi-app

  Template for ignosi-app

  '
Globals:
  Function:
    Timeout: 3
Resources:
  IgnosiFunction:
    Type: AWS::Serverless::Function
    Properties:
      CodeUri: IgnosiFunction
      Handler: app.handler
      Runtime: nodejs12.x
      Events:
        Ignosi:
          Type: Api
          Properties:
            Path: /ignosi
            Method: get
  IgnosiSNSTopic:
    Type: AWS::SNS::Topic
    Properties:
      Subscription:
      - Endpoint: Ahm.Asaduzzaman@icloud.com
        Protocol: email
  IgnosiQueue:
    Type: AWS::SQS::Queue
    Properties:
      VisibilityTimeout: 30
Outputs:
  IgnosiApi:
    Description: API Gateway endpoint URL for Prod stage for Ignosi function
    Value:
      Fn::Sub: https://${ServerlessRestApi}.execute-api.${AWS::Region}.amazonaws.com/Prod/ignosi/
  IgnosiFunction:
    Description: Ignosi Lambda Function ARN
    Value:
      Fn::GetAtt:
      - IgnosiFunction
      - Arn
  IgnosiFunctionIamRole:
    Description: Implicit IAM Role created for Ignosi function
    Value:
      Fn::GetAtt:
      - IgnosiFunctionRole
      - Arn
